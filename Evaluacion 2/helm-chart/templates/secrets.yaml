apiVersion: v1
kind: Secret
metadata:
  name: email-secret
  namespace: {{ .Values.namespace }}
type: Opaque
data:
  host: {{ .Values.email.host | b64enc }}
  port: {{ .Values.email.port | b64enc }}
  username: {{ .Values.email.username | b64enc }}
  password: {{ .Values.email.password | b64enc }}

---
{{- range .Values.microservices }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .name }}-db-secret
  namespace: {{ $.Values.namespace }}
type: Opaque
data:
  url: {{ printf "jdbc:postgresql://%s:5432/%s?sslmode=disable" .dbHost .dbName | b64enc }}
  username: {{ .dbUser | b64enc }}
  password: {{ .dbPassword | b64enc }}
---
{{- end }}
